<!DOCTYPE html>
<html lang="en">
<head>
    <title>ScrapeMaster</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        function showLoading() {
            document.getElementById("loading").style.display = "block";
            document.getElementById("scrape-button").disabled = true;
        }
    </script>
</head>
<body>
    <div class="container">
        <h1>ScrapeMaster</h1>
        <p class="subtitle">Extract data from the web efficiently.</p>

        {% if error_message %}
            <div class="error-box">{{ error_message }}</div>
        {% endif %}

        <form method="post" onsubmit="showLoading()">
            <label>Enter Website URL:</label>
            <input type="text" name="url" placeholder="https://example.com" required>

            <label>Select Data Type:</label>
            <select name="data_type">
                <option value="Text">Text</option>
                <option value="Links">Links</option>
                <option value="Images">Images</option>
                <option value="Videos">Videos</option>
            </select>

            <label>Keyword (Optional):</label>
            <input type="text" name="keyword" placeholder="Highlight results with this keyword">

            <div class="checkbox-group">
                <label><input type="checkbox" name="download_images"> Download Images</label>
                <label><input type="checkbox" name="download_videos"> Download Videos</label>
            </div>

            <button type="submit" id="scrape-button">Start Scraping</button>
        </form>

        <!-- Loading Spinner -->
        <div id="loading" class="loading-spinner" style="display: none;">
            Scraping in progress... Please wait.
        </div>

        {% if data %}
        <div class="results-container">
            <h2>Scraped Results</h2>
            <table>
                <thead>
                    <tr>
                        <th>Data Type</th>
                        <th>Extracted Data</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in data %}
                    <tr>
                        <td>{{ row['type'] }}</td>
                        <td>
                            {% if row['type'] == 'Images' %}
                                <img src="{{ row['content'] }}" alt="Scraped Image" class="scraped-img" width="150">
                            {% elif row['type'] == 'Videos' %}
                                {% if "youtube.com" in row['content'] or "youtu.be" in row['content'] %}
                                    <iframe class="scraped-video" width="250" height="150" src="{{ row['content'] }}" allowfullscreen></iframe>
                                {% else %}
                                    <video class="scraped-video" width="250" height="150" controls>
                                        <source src="{{ row['content'] }}" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                {% endif %}
                            {% else %}
                                {{ row['content'] }}
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>                
            </table>
        </div>
        {% endif %}
    </div>
</body>
</html>
